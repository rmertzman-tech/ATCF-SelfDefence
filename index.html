<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethics Beyond Boundaries - Your Lens & Coherence Check</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .atcf-meter {
            height: 40px;
            background: linear-gradient(to right, #dc2626 0%, #f59e0b 33%, #10b981 66%, #059669 100%);
            border-radius: 20px;
            position: relative;
            border: 3px solid #1f2937;
        }
        .atcf-indicator {
            position: absolute;
            width: 6px;
            height: 50px;
            background: white;
            border: 3px solid #1f2937;
            top: -5px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.4);
            border-radius: 3px;
        }
        .shield-icon {
            display: inline-block;
            font-size: 1.5em;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        @media print {
            .no-print { display: none; }
            body { background: white; }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [step, setStep] = useState('intro');
            const [studentName, setStudentName] = useState('');
            const [atcf, setATCF] = useState({
                historical: 5,
                present: 5,
                prospective: 5
            });
            const [prf, setPRF] = useState({
                experiences: ['', '', '', ''],
                values: [],
                lensPattern: '',
                blindSpots: [],
                growthAreas: ''
            });

            const avgATCF = ((atcf.historical + atcf.present + atcf.prospective) / 3).toFixed(1);

            return (
                <div className="min-h-screen pb-12">
                    <header className="gradient-bg text-white shadow-lg no-print">
                        <div className="max-w-4xl mx-auto px-4 py-6">
                            <h1 className="text-3xl font-bold mb-2">üõ°Ô∏è Your Lens & Coherence Check</h1>
                            <p className="text-lg opacity-90">Ethics Beyond Boundaries - Self-Defense Tool</p>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-4 py-8">
                        {step === 'intro' && <IntroStep onNext={() => setStep('atcf')} setName={setStudentName} name={studentName} />}
                        {step === 'atcf' && <ATCFStep atcf={atcf} setATCF={setATCF} onNext={() => setStep('prf')} onBack={() => setStep('intro')} />}
                        {step === 'prf' && <PRFStep prf={prf} setPRF={setPRF} onNext={() => setStep('results')} onBack={() => setStep('atcf')} />}
                        {step === 'results' && <ResultsStep name={studentName} atcf={atcf} prf={prf} avgATCF={avgATCF} onRestart={() => { setStep('intro'); setStudentName(''); setATCF({historical: 5, present: 5, prospective: 5}); setPRF({experiences: ['','','',''], values: [], lensPattern: '', blindSpots: [], growthAreas: ''}); }} />}
                    </main>
                </div>
            );
        }

        function IntroStep({ onNext, setName, name }) {
            return (
                <div className="bg-white rounded-lg shadow-lg p-8 fade-in">
                    <div className="text-center mb-6">
                        <span className="shield-icon">üõ°Ô∏è</span>
                    </div>
                    <h2 className="text-3xl font-bold text-gray-900 mb-6 text-center">Welcome to Your Self-Defense Tool</h2>
                    
                    <div className="bg-blue-50 border-l-4 border-blue-500 p-5 mb-6">
                        <p className="text-gray-700 mb-3">
                            <strong>This tool does two things:</strong>
                        </p>
                        <ol className="space-y-2 text-gray-700 list-decimal list-inside">
                            <li><strong>Maps your lens (PRF)</strong> - Shows you what's invisible so you can protect yourself</li>
                            <li><strong>Checks your coherence (ATCF)</strong> - Measures if you're okay right now (like blood pressure for your soul)</li>
                        </ol>
                    </div>

                    <div className="bg-yellow-50 border-l-4 border-yellow-500 p-5 mb-6">
                        <p className="font-semibold text-yellow-900 mb-2">‚ö° Why This Matters</p>
                        <p className="text-sm text-gray-700">
                            Roger Boisjoly didn't know his organizational blind spots. He couldn't track when the system 
                            was fragmenting him. <strong>You'll have both.</strong> This is your early warning system.
                        </p>
                    </div>

                    <div className="mb-6">
                        <label className="block text-sm font-semibold text-gray-700 mb-2">
                            First, what's your name?
                        </label>
                        <input
                            type="text"
                            value={name}
                            onChange={(e) => setName(e.target.value)}
                            placeholder="Enter your name"
                            className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-lg"
                        />
                    </div>

                    <button
                        onClick={onNext}
                        disabled={!name.trim()}
                        className={`w-full px-6 py-4 rounded-lg font-semibold transition-colors text-lg ${
                            name.trim() 
                                ? 'bg-purple-600 hover:bg-purple-700 text-white' 
                                : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        }`}
                    >
                        Start Your Self-Defense Check ‚Üí
                    </button>
                </div>
            );
        }

        function ATCFStep({ atcf, setATCF, onNext, onBack }) {
            const avgATCF = ((atcf.historical + atcf.present + atcf.prospective) / 3).toFixed(1);
            const isComplete = atcf.historical > 0 && atcf.present > 0 && atcf.prospective > 0;

            const getATCFColor = (score) => {
                if (score >= 8) return 'text-green-600';
                if (score >= 6.5) return 'text-yellow-600';
                if (score >= 5) return 'text-orange-600';
                return 'text-red-600';
            };

            const getATCFLabel = (score) => {
                if (score >= 8) return 'Strong - You\'re Thriving';
                if (score >= 6.5) return 'Moderate - Watch Carefully';
                if (score >= 5) return 'Warning - Needs Attention';
                return 'Crisis - Get Support Now';
            };

            const getDefensiveInsight = (score) => {
                if (score >= 8) return 'Your coherence is strong. Your meta-constructor capacity is working well - you\'re adapting while staying integrated. Keep doing what you\'re doing.';
                if (score >= 6.5) return 'You\'re holding together but there\'s stress. Your meta-constructor is working but being challenged. Pay attention to what\'s causing tension. This is your early warning system - don\'t ignore it.';
                if (score >= 5) return 'Warning level. Something in your life is fragmenting you. Your meta-constructor is struggling to maintain coherence. Identify what\'s causing this and make changes. Below 7 for 3 months = intervention needed.';
                return 'Crisis level. Your coherence is severely compromised. Your meta-constructor cannot maintain integration under current conditions. You need support NOW. Talk to counseling services, trusted mentor, or professional. This is not sustainable.';
            };

            return (
                <div className="bg-white rounded-lg shadow-lg p-8 fade-in">
                    <h2 className="text-3xl font-bold text-gray-900 mb-6">
                        üõ°Ô∏è ATCF Check: Your Coherence Score
                    </h2>

                    <div className="bg-purple-50 border-l-4 border-purple-500 p-5 mb-6">
                        <p className="text-gray-700 mb-2">
                            <strong>ATCF = Adaptive Temporal Coherence Function</strong>
                        </p>
                        <p className="text-sm text-gray-700">
                            Think of this like blood pressure for your psychological wellbeing. It measures three things:
                            Can you trace a coherent story (Past)? Do your life domains support each other (Present)? 
                            Can you imagine authentic futures (Future)?
                        </p>
                    </div>

                    {/* Historical Continuity */}
                    <div className="bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-blue-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-blue-900 mb-3">üìñ Past: Historical Continuity</h3>
                        <p className="text-gray-700 mb-4">Can you trace a coherent story from your past to present?</p>
                        
                        <div className="bg-white rounded-lg p-4 mb-4 space-y-2 text-sm">
                            <p><strong>9-10:</strong> Clear story - I understand how I got here</p>
                            <p><strong>6-8:</strong> Mostly coherent - few disconnections I can explain</p>
                            <p><strong>3-5:</strong> Some breaks - changes I don't fully understand</p>
                            <p><strong>1-2:</strong> Fragmented - can't explain how I became who I am</p>
                        </div>

                        <input
                            type="range"
                            min="1"
                            max="10"
                            value={atcf.historical}
                            onChange={(e) => setATCF({...atcf, historical: parseInt(e.target.value)})}
                            className="w-full h-3 rounded-lg appearance-none cursor-pointer"
                            style={{background: `linear-gradient(to right, #dc2626 0%, #f59e0b 50%, #10b981 100%)`}}
                        />
                        <div className="flex justify-between text-sm text-gray-600 mt-2">
                            <span>Crisis</span>
                            <span className={`text-2xl font-bold ${getATCFColor(atcf.historical)}`}>
                                {atcf.historical}
                            </span>
                            <span>Strong</span>
                        </div>
                    </div>

                    {/* Present Integration */}
                    <div className="bg-gradient-to-br from-green-50 to-blue-50 border-2 border-green-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-green-900 mb-3">‚öñÔ∏è Present: Life Integration</h3>
                        <p className="text-gray-700 mb-4">Do your life domains support or fight each other?</p>
                        
                        <div className="bg-white rounded-lg p-4 mb-4 space-y-2 text-sm">
                            <p><strong>9-10:</strong> Work, relationships, health, learning all support each other</p>
                            <p><strong>6-8:</strong> Most domains align - one or two tensions but manageable</p>
                            <p><strong>3-5:</strong> Significant conflicts - pulled in different directions</p>
                            <p><strong>1-2:</strong> Major warfare - domains destroying each other</p>
                        </div>

                        <input
                            type="range"
                            min="1"
                            max="10"
                            value={atcf.present}
                            onChange={(e) => setATCF({...atcf, present: parseInt(e.target.value)})}
                            className="w-full h-3 rounded-lg appearance-none cursor-pointer"
                        />
                        <div className="flex justify-between text-sm text-gray-600 mt-2">
                            <span>Crisis</span>
                            <span className={`text-2xl font-bold ${getATCFColor(atcf.present)}`}>
                                {atcf.present}
                            </span>
                            <span>Strong</span>
                        </div>
                    </div>

                    {/* Prospective Coherence */}
                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-purple-900 mb-3">üîÆ Future: Prospective Coherence</h3>
                        <p className="text-gray-700 mb-4">Can you imagine authentic futures from here?</p>
                        
                        <div className="bg-white rounded-lg p-4 mb-4 space-y-2 text-sm">
                            <p><strong>9-10:</strong> Multiple good paths forward, all recognizably me</p>
                            <p><strong>6-8:</strong> Clear path forward that feels authentic</p>
                            <p><strong>3-5:</strong> Future foggy or requires abandoning parts of myself</p>
                            <p><strong>1-2:</strong> Can't imagine future without betraying who I am</p>
                        </div>

                        <input
                            type="range"
                            min="1"
                            max="10"
                            value={atcf.prospective}
                            onChange={(e) => setATCF({...atcf, prospective: parseInt(e.target.value)})}
                            className="w-full h-3 rounded-lg appearance-none cursor-pointer"
                        />
                        <div className="flex justify-between text-sm text-gray-600 mt-2">
                            <span>Crisis</span>
                            <span className={`text-2xl font-bold ${getATCFColor(atcf.prospective)}`}>
                                {atcf.prospective}
                            </span>
                            <span>Strong</span>
                        </div>
                    </div>

                    {/* Combined Score */}
                    {isComplete && (
                        <div className="bg-white border-4 border-gray-300 rounded-lg p-6 mb-6">
                            <h3 className="text-2xl font-bold text-gray-900 mb-4 text-center">Your Combined ATCF Score</h3>
                            
                            <div className="text-center mb-4">
                                <p className={`text-6xl font-bold mb-2 ${getATCFColor(avgATCF)}`}>
                                    {avgATCF}
                                </p>
                                <p className={`text-xl font-semibold ${getATCFColor(avgATCF)}`}>
                                    {getATCFLabel(avgATCF)}
                                </p>
                            </div>

                            <div className="atcf-meter mb-4">
                                <div 
                                    className="atcf-indicator"
                                    style={{ left: `calc(${(avgATCF / 10) * 100}% - 3px)` }}
                                ></div>
                            </div>
                            <div className="flex justify-between text-xs text-gray-600 mb-6">
                                <span>1<br/>Crisis</span>
                                <span>5<br/>Warning</span>
                                <span>7<br/>Moderate</span>
                                <span>10<br/>Strong</span>
                            </div>

                            <div className={`p-5 rounded-lg ${
                                avgATCF >= 8 ? 'bg-green-50 border-l-4 border-green-500' :
                                avgATCF >= 6.5 ? 'bg-yellow-50 border-l-4 border-yellow-500' :
                                avgATCF >= 5 ? 'bg-orange-50 border-l-4 border-orange-500' :
                                'bg-red-50 border-l-4 border-red-500'
                            }`}>
                                <p className="font-semibold mb-2">üõ°Ô∏è What This Means for Your Self-Defense:</p>
                                <p className="text-sm text-gray-700">
                                    {getDefensiveInsight(avgATCF)}
                                </p>
                            </div>

                            {avgATCF < 5 && (
                                <div className="mt-4 bg-red-100 border-2 border-red-500 rounded-lg p-4">
                                    <p className="font-bold text-red-900 mb-2">üö® URGENT: Get Support Now</p>
                                    <ul className="text-sm text-gray-800 space-y-1">
                                        <li>‚Ä¢ Campus Counseling: [Your college counseling center]</li>
                                        <li>‚Ä¢ Crisis Text Line: Text HOME to 741741</li>
                                        <li>‚Ä¢ National Suicide Prevention: 988</li>
                                        <li>‚Ä¢ Talk to: Trusted professor, advisor, mentor, family member</li>
                                    </ul>
                                </div>
                            )}
                        </div>
                    )}

                    {/* Navigation */}
                    <div className="flex justify-between">
                        <button
                            onClick={onBack}
                            className="px-6 py-3 bg-gray-300 hover:bg-gray-400 rounded-lg font-semibold transition-colors"
                        >
                            ‚Üê Back
                        </button>
                        <button
                            onClick={onNext}
                            disabled={!isComplete}
                            className={`px-6 py-3 rounded-lg font-semibold transition-colors ${
                                isComplete 
                                    ? 'bg-purple-600 hover:bg-purple-700 text-white' 
                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                            }`}
                        >
                            Continue to Map Your Lens ‚Üí
                        </button>
                    </div>
                </div>
            );
        }

        function PRFStep({ prf, setPRF, onNext, onBack }) {
            const values = [
                'Justice/Fairness', 'Compassion/Care', 'Honesty/Integrity', 'Loyalty/Fidelity',
                'Freedom/Autonomy', 'Excellence/Achievement', 'Wisdom/Understanding', 'Courage/Bravery',
                'Community/Belonging', 'Family/Kinship', 'Security/Safety', 'Growth/Learning',
                'Faith/Spirituality', 'Creativity/Expression', 'Service/Contribution'
            ];

            const toggleValue = (value) => {
                if (prf.values.includes(value)) {
                    setPRF({...prf, values: prf.values.filter(v => v !== value)});
                } else if (prf.values.length < 5) {
                    setPRF({...prf, values: [...prf.values, value]});
                }
            };

            const updateExperience = (index, value) => {
                const newExp = [...prf.experiences];
                newExp[index] = value;
                setPRF({...prf, experiences: newExp});
            };

            const filledExperiences = prf.experiences.filter(e => e.trim()).length;
            const isComplete = filledExperiences >= 3 && prf.values.length >= 3 && prf.growthAreas.trim();

            return (
                <div className="bg-white rounded-lg shadow-lg p-8 fade-in">
                    <h2 className="text-3xl font-bold text-gray-900 mb-6">
                        üîç Map Your Lens (PRF)
                    </h2>

                    <div className="bg-blue-50 border-l-4 border-blue-500 p-5 mb-6">
                        <p className="text-gray-700">
                            Your <strong>PRF (Phenomenological Reference Framework)</strong> is your interpretive lens. 
                            It determines what you see first, what triggers emotions, and what seems obvious. 
                            <strong> Knowing your lens is the first move in self-defense.</strong>
                        </p>
                    </div>

                    {/* Formative Experiences */}
                    <div className="bg-gradient-to-br from-purple-50 to-blue-50 border-2 border-purple-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-purple-900 mb-3">
                            üìñ Formative Experiences (Add at least 3)
                        </h3>
                        <p className="text-sm text-gray-700 mb-4">
                            What experiences shaped your lens? Be specific.
                        </p>

                        <div className="space-y-3">
                            {prf.experiences.map((exp, i) => (
                                <div key={i}>
                                    <label className="block text-xs font-semibold text-gray-600 mb-1">
                                        Experience {i + 1}:
                                    </label>
                                    <input
                                        type="text"
                                        value={exp}
                                        onChange={(e) => updateExperience(i, e.target.value)}
                                        placeholder={
                                            i === 0 ? "e.g., Parents' divorce taught me about financial vulnerability" :
                                            i === 1 ? "e.g., Being bullied made me sensitive to power dynamics" :
                                            i === 2 ? "e.g., Volunteer work revealed privilege I'd been blind to" :
                                            "Add another experience..."
                                        }
                                        className="w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none text-sm"
                                    />
                                </div>
                            ))}
                        </div>
                        <p className="text-xs text-gray-600 mt-2">
                            Filled: {filledExperiences}/4 (minimum 3 required)
                        </p>
                    </div>

                    {/* Core Values */}
                    <div className="bg-gradient-to-br from-green-50 to-blue-50 border-2 border-green-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-green-900 mb-3">
                            ‚≠ê Core Values (Select 3-5)
                        </h3>
                        <p className="text-sm text-gray-700 mb-4">
                            What values actually drive you? Pick your top 3-5.
                        </p>

                        <div className="grid grid-cols-2 md:grid-cols-3 gap-2">
                            {values.map(value => (
                                <button
                                    key={value}
                                    onClick={() => toggleValue(value)}
                                    className={`px-3 py-2 rounded-lg text-sm font-semibold transition-colors ${
                                        prf.values.includes(value)
                                            ? 'bg-green-600 text-white'
                                            : 'bg-white border-2 border-gray-300 hover:border-green-500'
                                    }`}
                                    disabled={!prf.values.includes(value) && prf.values.length >= 5}
                                >
                                    {value}
                                </button>
                            ))}
                        </div>
                        <p className="text-xs text-gray-600 mt-2">
                            Selected: {prf.values.length}/5
                        </p>
                    </div>

                    {/* Growth Areas */}
                    <div className="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-lg p-6 mb-6">
                        <h3 className="text-xl font-bold text-yellow-900 mb-3">
                            üå± Growth Areas
                        </h3>
                        <p className="text-sm text-gray-700 mb-4">
                            What perspectives do you want to understand better? Where do you want to expand your lens?
                        </p>
                        <textarea
                            value={prf.growthAreas}
                            onChange={(e) => setPRF({...prf, growthAreas: e.target.value})}
                            placeholder="e.g., I want to understand justice-focused thinking better, develop more practical problem-solving skills, learn to set boundaries..."
                            className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-yellow-500 focus:outline-none"
                            rows="4"
                        />
                    </div>

                    {/* Navigation */}
                    <div className="flex justify-between">
                        <button
                            onClick={onBack}
                            className="px-6 py-3 bg-gray-300 hover:bg-gray-400 rounded-lg font-semibold transition-colors"
                        >
                            ‚Üê Back
                        </button>
                        <button
                            onClick={onNext}
                            disabled={!isComplete}
                            className={`px-6 py-3 rounded-lg font-semibold transition-colors ${
                                isComplete 
                                    ? 'bg-purple-600 hover:bg-purple-700 text-white' 
                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                            }`}
                        >
                            {isComplete ? 'See Your Results ‚Üí' : `Complete All Sections (${isComplete ? '‚úì' : '...'} )`}
                        </button>
                    </div>
                </div>
            );
        }

        function ResultsStep({ name, atcf, prf, avgATCF, onRestart }) {
            const getATCFColor = (score) => {
                if (score >= 8) return 'text-green-600';
                if (score >= 6.5) return 'text-yellow-600';
                if (score >= 5) return 'text-orange-600';
                return 'text-red-600';
            };

            const getLensPattern = () => {
                const vals = prf.values.map(v => v.toLowerCase());
                if (vals.some(v => v.includes('justice') || v.includes('fair'))) return 'Justice-Focused';
                if (vals.some(v => v.includes('care') || v.includes('compassion'))) return 'Care-Focused';
                if (vals.some(v => v.includes('excellence') || v.includes('wisdom'))) return 'Virtue-Focused';
                if (vals.some(v => v.includes('freedom') || v.includes('autonomy'))) return 'Freedom-Focused';
                return 'Balanced/Mixed';
            };

            const getLensStrengths = () => {
                const pattern = getLensPattern();
                const strengths = {
                    'Justice-Focused': ['See fairness violations others miss', 'Strong sense of right and wrong', 'Advocate for equity'],
                    'Care-Focused': ['Deep empathy for others', 'See human complexity', 'Build strong relationships'],
                    'Virtue-Focused': ['Focus on character development', 'High personal standards', 'Long-term thinking'],
                    'Freedom-Focused': ['Value autonomy and independence', 'Respect individual choice', 'Creative problem-solving'],
                    'Balanced/Mixed': ['See multiple perspectives', 'Flexible in approach', 'Integrate different values']
                };
                return strengths[pattern] || strengths['Balanced/Mixed'];
            };

            const getLensBlindSpots = () => {
                const pattern = getLensPattern();
                const blindSpots = {
                    'Justice-Focused': ['May prioritize fairness over compassion', 'Can be rigid about rules', 'Might miss personal context'],
                    'Care-Focused': ['May be taken advantage of', 'Can avoid necessary conflict', 'Might miss systemic injustice'],
                    'Virtue-Focused': ['Can be judgmental', 'May prioritize ideals over practicality', 'Might struggle with compromise'],
                    'Freedom-Focused': ['May undervalue community obligations', 'Can be too individualistic', 'Might resist necessary structure'],
                    'Balanced/Mixed': ['May struggle to commit to one approach', 'Can be indecisive', 'Might lack strong conviction']
                };
                return blindSpots[pattern] || blindSpots['Balanced/Mixed'];
            };

            const getProtectiveInsights = () => {
                if (avgATCF >= 8) {
                    return [
                        'Your coherence is strong. Keep monitoring weekly to maintain this.',
                        'Your meta-constructor capacity is working well - you\'re adapting without fragmenting.',
                        'Use your lens strengths consciously. Be aware of blind spots when making decisions.',
                        'Your growth areas show self-awareness. Continue expanding your perspective.'
                    ];
                } else if (avgATCF >= 6.5) {
                    return [
                        'You\'re holding together but experiencing stress. Something is challenging your coherence.',
                        'Your meta-constructor is working but being tested. Pay attention to what\'s causing tension.',
                        'Your lens blind spots may be contributing to stress. Be especially careful in those areas.',
                        'Track your ATCF weekly. If it drops below 6.5 for a month, make changes.'
                    ];
                } else if (avgATCF >= 5) {
                    return [
                        'WARNING: Your coherence is compromised. Something in your life is fragmenting you.',
                        'Your meta-constructor is struggling to maintain integration. Identify what\'s causing this NOW.',
                        'Your lens blind spots are making you vulnerable. Get help seeing what you\'re missing.',
                        'Action needed: Below 7 for 3 months = intervention required. Don\'t wait.'
                    ];
                } else {
                    return [
                        'CRISIS: Your coherence is severely compromised. Get support immediately.',
                        'Your meta-constructor cannot maintain integration under current conditions.',
                        'You need outside perspective NOW. Talk to counseling, trusted mentor, or professional.',
                        'This is not sustainable. Make changes or exit current situation. Protect yourself.'
                    ];
                }
            };

            const downloadReport = () => {
                const report = `
ETHICS BEYOND BOUNDARIES - SELF-DEFENSE REPORT
==============================================
Student: ${name}
Date: ${new Date().toLocaleDateString()}

üõ°Ô∏è YOUR ATCF SCORE (Coherence Check)
====================================
Past (Historical Continuity): ${atcf.historical}/10
Present (Life Integration): ${atcf.present}/10
Future (Prospective Coherence): ${atcf.prospective}/10

COMBINED ATCF: ${avgATCF}/10
STATUS: ${avgATCF >= 8 ? 'Strong - Thriving' : avgATCF >= 6.5 ? 'Moderate - Watch Carefully' : avgATCF >= 5 ? 'Warning - Needs Attention' : 'Crisis - Get Support Now'}

üîç YOUR LENS (PRF) PROFILE
==========================
PRIMARY PATTERN: ${getLensPattern()}

TOP VALUES:
${prf.values.map((v, i) => `${i + 1}. ${v}`).join('\n')}

FORMATIVE EXPERIENCES:
${prf.experiences.filter(e => e.trim()).map((e, i) => `${i + 1}. ${e}`).join('\n')}

LENS STRENGTHS:
${getLensStrengths().map(s => `‚úì ${s}`).join('\n')}

LENS BLIND SPOTS (What you might miss):
${getLensBlindSpots().map(b => `‚ö† ${b}`).join('\n')}

GROWTH AREAS:
${prf.growthAreas}

üõ°Ô∏è PROTECTIVE INSIGHTS
======================
${getProtectiveInsights().map((insight, i) => `${i + 1}. ${insight}`).join('\n\n')}

üìã ACTION ITEMS
==============
1. Track your ATCF weekly using this tool
2. Be especially careful when your lens blind spots apply
3. Use SAGE framework (next class) when making important decisions
4. If ATCF stays below 7 for 3 months, make changes or get help
5. Practice seeing through other lenses (we'll learn 4 major ones)

üö® IF IN CRISIS (ATCF below 5)
==============================
- Campus Counseling: [Your college counseling center]
- Crisis Text Line: Text HOME to 741741
- National Suicide Prevention: 988
- Talk to: Trusted professor, advisor, mentor, family member

Remember: You're building a protection system. This is just Move #1.
By Class 24, you'll have the complete self-defense toolkit.

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
Save this report. Reference it throughout the semester.
Update it monthly to track your coherence over time.
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                `.trim();

                const blob = new Blob([report], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${name.replace(/\s+/g, '_')}_Self_Defense_Report.txt`;
                a.click();
                URL.revokeObjectURL(url);
            };

            const printReport = () => {
                window.print();
            };

            return (
                <div className="bg-white rounded-lg shadow-lg p-8 fade-in">
                    <div className="text-center mb-6 no-print">
                        <span className="text-6xl">üõ°Ô∏è</span>
                    </div>
                    <h2 className="text-3xl font-bold text-gray-900 mb-6 text-center">
                        {name}'s Self-Defense Report
                    </h2>

                    {/* ATCF Summary */}
                    <div className="bg-gradient-to-br from-purple-100 to-blue-100 border-4 border-purple-400 rounded-lg p-6 mb-6">
                        <h3 className="text-2xl font-bold text-purple-900 mb-4 text-center">
                            Your Coherence Score (ATCF)
                        </h3>
                        <div className="text-center mb-4">
                            <p className={`text-7xl font-bold mb-2 ${getATCFColor(avgATCF)}`}>
                                {avgATCF}
                            </p>
                            <p className="text-xl text-gray-700 mb-2">
                                Past: {atcf.historical} | Present: {atcf.present} | Future: {atcf.prospective}
                            </p>
                        </div>
                        <div className="atcf-meter mb-4">
                            <div 
                                className="atcf-indicator"
                                style={{ left: `calc(${(avgATCF / 10) * 100}% - 3px)` }}
                            ></div>
                        </div>
                    </div>

                    {/* PRF Summary */}
                    <div className="bg-gradient-to-br from-blue-50 to-green-50 border-2 border-blue-300 rounded-lg p-6 mb-6">
                        <h3 className="text-2xl font-bold text-blue-900 mb-4">Your Lens (PRF) Profile</h3>
                        
                        <div className="mb-4">
                            <p className="font-semibold text-gray-700 mb-2">PRIMARY PATTERN:</p>
                            <p className="text-xl font-bold text-blue-600">{getLensPattern()}</p>
                        </div>

                        <div className="mb-4">
                            <p className="font-semibold text-gray-700 mb-2">TOP VALUES:</p>
                            <div className="flex flex-wrap gap-2">
                                {prf.values.map(v => (
                                    <span key={v} className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold">
                                        {v}
                                    </span>
                                ))}
                            </div>
                        </div>

                        <div className="grid md:grid-cols-2 gap-4 mb-4">
                            <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                <p className="font-semibold text-green-900 mb-2">‚úì Lens Strengths:</p>
                                <ul className="text-sm text-gray-700 space-y-1">
                                    {getLensStrengths().map((s, i) => (
                                        <li key={i}>‚Ä¢ {s}</li>
                                    ))}
                                </ul>
                            </div>
                            <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                <p className="font-semibold text-yellow-900 mb-2">‚ö† Lens Blind Spots:</p>
                                <ul className="text-sm text-gray-700 space-y-1">
                                    {getLensBlindSpots().map((b, i) => (
                                        <li key={i}>‚Ä¢ {b}</li>
                                    ))}
                                </ul>
                            </div>
                        </div>

                        <div className="mb-4">
                            <p className="font-semibold text-gray-700 mb-2">FORMATIVE EXPERIENCES:</p>
                            <ul className="text-sm text-gray-700 space-y-1">
                                {prf.experiences.filter(e => e.trim()).map((e, i) => (
                                    <li key={i}>‚Ä¢ {e}</li>
                                ))}
                            </ul>
                        </div>

                        <div>
                            <p className="font-semibold text-gray-700 mb-2">GROWTH AREAS:</p>
                            <p className="text-sm text-gray-700">{prf.growthAreas}</p>
                        </div>
                    </div>

                    {/* Protective Insights */}
                    <div className={`border-4 rounded-lg p-6 mb-6 ${
                        avgATCF >= 8 ? 'bg-green-50 border-green-400' :
                        avgATCF >= 6.5 ? 'bg-yellow-50 border-yellow-400' :
                        avgATCF >= 5 ? 'bg-orange-50 border-orange-400' :
                        'bg-red-50 border-red-400'
                    }`}>
                        <h3 className="text-2xl font-bold text-gray-900 mb-4">üõ°Ô∏è Your Protective Insights</h3>
                        <ol className="space-y-3 text-gray-800">
                            {getProtectiveInsights().map((insight, i) => (
                                <li key={i} className="flex">
                                    <span className="font-bold mr-2">{i + 1}.</span>
                                    <span>{insight}</span>
                                </li>
                            ))}
                        </ol>
                    </div>

                    {/* Action Items */}
                    <div className="bg-blue-50 border-2 border-blue-300 rounded-lg p-6 mb-6">
                        <h3 className="text-2xl font-bold text-blue-900 mb-4">üìã Your Action Items</h3>
                        <ol className="space-y-2 text-gray-700">
                            <li>1. <strong>Track your ATCF weekly</strong> - Use this tool every Sunday</li>
                            <li>2. <strong>Watch your blind spots</strong> - Be extra careful when they apply</li>
                            <li>3. <strong>Learn SAGE next class</strong> - Systematic method for decisions</li>
                            <li>4. <strong>Intervene if needed</strong> - ATCF below 7 for 3 months = make changes</li>
                            <li>5. <strong>Expand your lens</strong> - Learn to see through other perspectives</li>
                        </ol>
                    </div>

                    {avgATCF < 5 && (
                        <div className="bg-red-100 border-4 border-red-500 rounded-lg p-6 mb-6">
                            <h3 className="text-2xl font-bold text-red-900 mb-4">üö® GET SUPPORT NOW</h3>
                            <ul className="text-gray-800 space-y-2">
                                <li>‚Ä¢ <strong>Campus Counseling:</strong> [Your college counseling center]</li>
                                <li>‚Ä¢ <strong>Crisis Text Line:</strong> Text HOME to 741741</li>
                                <li>‚Ä¢ <strong>National Suicide Prevention:</strong> 988</li>
                                <li>‚Ä¢ <strong>Talk to:</strong> Trusted professor, advisor, mentor, family member</li>
                            </ul>
                        </div>
                    )}

                    {/* Buttons */}
                    <div className="grid md:grid-cols-2 gap-4 mb-6 no-print">
                        <button
                            onClick={downloadReport}
                            className="px-6 py-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors text-lg"
                        >
                            üì• Download Full Report
                        </button>
                        <button
                            onClick={printReport}
                            className="px-6 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors text-lg"
                        >
                            üñ®Ô∏è Print This Report
                        </button>
                    </div>

                    <div className="text-center no-print">
                        <p className="text-sm text-gray-600 mb-4">
                            Save this report. Reference it throughout the semester. Update it monthly.
                        </p>
                        <button
                            onClick={onRestart}
                            className="px-6 py-3 bg-gray-300 hover:bg-gray-400 rounded-lg font-semibold transition-colors"
                        >
                            Start Over
                        </button>
                    </div>
                </div>
            );
        }

        // Render
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
